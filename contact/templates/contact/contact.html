{% extends "layouts/base.html" %}
{% load static %}

{% block stylesheets %}
<style>
  :root{
    --background:#fff;--foreground:oklch(.145 0 0);
    --card:#fff;--card-foreground:oklch(.145 0 0);
    --primary:#030213;--primary-foreground:#fff;
    --secondary:oklch(.95 .0058 264.53);--secondary-foreground:#030213;
    --muted:#ececf0;--muted-foreground:#717182;
    --accent:#e9ebef;--accent-foreground:#030213;
    --destructive:#d4183d;--destructive-foreground:#fff;
    --border:#0000001a;--input:transparent;--input-background:#f3f3f5;
    --ring:oklch(.708 0 0);
    --radius:.625rem;
  }
  .page-transition{animation: .3s ease-in-out fadeIn}
  @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
  @keyframes slideInRight{from{opacity:0;transform:translateX(30px)}to{opacity:1;transform:translateX(0)}}
  @keyframes slideInLeft{from{opacity:0;transform:translateX(-30px)}to{opacity:1;transform:translateX(0)}}
  @keyframes scaleIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
  .animate-fade-in{animation:.8s ease-out fadeIn}
  .animate-slide-in-right{animation:.6s ease-out slideInRight}
  .animate-slide-in-left{animation:.6s ease-out slideInLeft}
  .animate-scale-in{animation:.5s ease-out scaleIn}
  .hover-lift{transition:all .3s cubic-bezier(.4,0,.2,1)}
  .hover-lift:hover{transform:translateY(-8px);box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04)}
</style>
{% endblock stylesheets %}

{% block content %}
<body class="min-h-screen bg-white text-gray-900 selection:bg-primary selection:text-white">

  <main class="transition-opacity duration-300 opacity-100">
    <div class="min-h-screen">
      <!-- Hero -->
      <section class="bg-gradient-to-r from-orange-600 via-orange-700 to-cyan-600 pt-36 py-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <h1 class="text-4xl sm:text-5xl text-white mb-6 animate-fade-in">Contactez-Nous</h1>
          <p class="text-xl text-orange-100 max-w-3xl mx-auto animate-fade-in">Nous sommes à votre écoute pour répondre à toutes vos questions</p>
        </div>
      </section>
      

      <!-- Coordonnées -->
      <section class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="text-center mb-16 animate-fade-in">
            <h2 class="text-orange-900 mb-4 text-3xl font-medium">Nos Coordonnées</h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">Plusieurs moyens de nous joindre</p>
          </div>

          <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16">
            <!-- Adresse -->
            <div class="animate-slide-in-left bg-white flex flex-col gap-6 rounded-xl group hover:shadow-xl hover:-translate-y-2 transition-all duration-300 border border-transparent">
              <div class="p-6 text-center">
                <div class="w-16 h-16 rounded-full bg-orange-100 flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-orange-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"/>
                    <circle cx="12" cy="10" r="3"/>
                  </svg>
                </div>
                <h3 class="text-gray-900 mb-3 text-lg font-medium">Adresse</h3>
                <p class="text-gray-600 text-sm mb-1">Wanindara Dispensaire, Commune de Matoto</p>
                <p class="text-gray-600 text-sm mb-1">Conakry, République de Guinée</p>
              </div>
            </div>

            <!-- Téléphone -->
            <div class="animate-slide-in-left bg-white flex flex-col gap-6 rounded-xl group hover:shadow-xl hover:-translate-y-2 transition-all duration-300 border border-transparent">
              <div class="p-6 text-center">
                <div class="w-16 h-16 rounded-full bg-cyan-100 flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-cyan-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                  </svg>
                </div>
                <h3 class="text-gray-900 mb-3 text-lg font-medium">Téléphone</h3>
                <p class="text-gray-600 text-sm mb-1">+224 629829087</p>
                <p class="text-gray-600 text-sm mb-1">+224 628408340</p>
              </div>
            </div>

            <!-- Email -->
            <div class="animate-slide-in-right bg-white flex flex-col gap-6 rounded-xl group hover:shadow-xl hover:-translate-y-2 transition-all duration-300 border border-transparent">
              <div class="p-6 text-center">
                <div class="w-16 h-16 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                    <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
                  </svg>
                </div>
                <h3 class="text-gray-900 mb-3 text-lg font-medium">Email</h3>
                <p class="text-gray-600 text-sm mb-1">deboutwanindara@gmail.com</p>
            
              </div>
            </div>

            <!-- Heures -->
            <div class="animate-slide-in-right bg-white flex flex-col gap-6 rounded-xl group hover:shadow-xl hover:-translate-y-2 transition-all duration-300 border border-transparent">
              <div class="p-6 text-center">
                <div class="w-16 h-16 rounded-full bg-teal-100 flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-teal-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                </div>
                <h3 class="text-gray-900 mb-3 text-lg font-medium">Heures d'ouverture</h3>
                <p class="text-gray-600 text-sm mb-1">Lundi - Vendredi: 8h00 - 17h00</p>
                <p class="text-gray-600 text-sm mb-1">Samedi: 9h00 - 13h00</p>
              </div>
            </div>
          </div>

          <!-- Réseaux sociaux (ronds) -->
          <div class="text-center mb-16">
            <h3 class="text-gray-900 mb-6 text-xl font-medium">Suivez-nous sur les réseaux sociaux</h3>
            <div class="flex justify-center gap-4">
              <a href="https://www.facebook.com/share/1G7xz31P88/?mibextid=wwXIfr " class="w-14 h-14 rounded-full bg-gray-100 hover:bg-blue-600 hover:text-white flex items-center justify-center transition-all duration-300 hover:scale-110">
                <!-- Facebook -->
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>
              </a>
              <a href="https://x.com/dwanindara?s=11" class="w-14 h-14 rounded-full bg-gray-100 hover:bg-blue-400 hover:text-white flex items-center justify-center transition-all duration-300 hover:scale-110">
                <!-- Twitter/X -->
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/></svg>
              </a>
              
              <a href="https://www.linkedin.com/in/debout-wanindara-b2338839a?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app" class="w-14 h-14 rounded-full bg-gray-100 hover:bg-blue-700 hover:text-white flex items-center justify-center transition-all duration-300 hover:scale-110">
                <!-- Linkedin -->
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg>
              </a>
              <a href="http://wa.me/224628408340" class="w-14 h-14 rounded-full bg-gray-100 hover:bg-green-600 hover:text-white flex items-center justify-center transition-all duration-300 hover:scale-110">
                <!-- WhatsApp -->
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2C6.48 2 2 6.02 2 11.5c0 2.04.66 3.93 1.79 5.49L2 22l5.2-1.71A9.77 9.77 0 0 0 12 21c5.52 0 10-4.48 10-9.5S17.52 2 12 2zm0 17c-1.64 0-3.17-.5-4.46-1.36l-.32-.21-3.09 1.02 1.02-3.01-.21-.33A7.46 7.46 0 0 1 4.5 11.5C4.5 7.36 8.08 4 12 4s7.5 3.36 7.5 7.5S15.92 19 12 19z"></path></svg>
              </a>
            </div>
          </div>
        </div>
      </section>

      <!-- FAQ -->
      <section class="py-20 bg-gray-50">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="text-center mb-16">
            <h2 class="text-orange-900 mb-4 text-3xl font-medium">Questions Fréquentes</h2>
            <p class="text-xl text-gray-600">Trouvez rapidement les réponses à vos questions</p>
          </div>

          <div class="space-y-6">
            <div class="bg-white rounded-xl hover:shadow-lg transition-shadow">
              <div class="p-6">
                <h4 class="text-orange-900 mb-3 text-lg font-medium">Comment puis-je devenir membre ?</h4>
                <p class="text-gray-700">Remplissez le formulaire d'adhésion dans la section "Rejoignez-Nous" et vous recevrez votre badge digital immédiatement.</p>
              </div>
            </div>
            <div class="bg-white rounded-xl hover:shadow-lg transition-shadow">
              <div class="p-6">
                <h4 class="text-orange-900 mb-3 text-lg font-medium">Y a-t-il des frais d'adhésion ?</h4>
                <p class="text-gray-700">Les modalités d'adhésion varient selon le type de membership. Contactez-nous pour plus d'informations.</p>
              </div>
            </div>
            <div class="bg-white rounded-xl hover:shadow-lg transition-shadow">
              <div class="p-6">
                <h4 class="text-orange-900 mb-3 text-lg font-medium">Puis-je participer aux projets sans être membre ?</h4>
                <p class="text-gray-700">Oui, nous accueillons toujours les bénévoles pour nos actions. Contactez-nous pour connaître les opportunités disponibles.</p>
              </div>
            </div>
            <div class="bg-white rounded-xl hover:shadow-lg transition-shadow">
              <div class="p-6">
                <h4 class="text-orange-900 mb-3 text-lg font-medium">Comment puis-je soutenir vos actions ?</h4>
                <p class="text-gray-700">Plusieurs options : devenir membre, faire un don, participer comme bénévole, ou établir un partenariat avec votre organisation.</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Formulaire + infos -->
      <section class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="text-center mb-16">
            <h2 class="text-orange-900 mb-4 text-3xl font-medium">Envoyez-nous un Message</h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">Utilisez le formulaire ci-dessous pour nous contacter directement</p>
          </div>

          <div class="grid lg:grid-cols-2 gap-12">
            <!-- Form Card -->
            <div class="bg-white rounded-xl border">
              <div class="px-6 pt-6">
                <h4 class="leading-none text-xl font-medium">Envoyez-nous un Message</h4>
              </div>
              <div class="px-6 pb-6">
                <form id="contactForm" method="post" class="space-y-6" novalidate>
                  <!-- AJOUT DU CSRF TOKEN -->
                  {% csrf_token %}
                  
                  <div class="grid md:grid-cols-2 gap-4">
                    <div>
                      <label for="contact-name" class="flex items-center gap-2 text-sm font-medium">Nom Complet</label>
                      <input id="contact-name" name="name" placeholder="Votre nom" required
                             class="border flex h-10 w-full rounded-md px-3 py-2 bg-[var(--input-background)] outline-none focus:border-orange-500"/>
                      <p class="mt-1 text-sm text-red-600 hidden" data-error="name">Veuillez renseigner votre nom.</p>
                    </div>
                    <div>
                      <label for="contact-email" class="flex items-center gap-2 text-sm font-medium">Email</label>
                      <input id="contact-email" name="email" type="email" placeholder="votre@email.com" required
                             class="border flex h-10 w-full rounded-md px-3 py-2 bg-[var(--input-background)] outline-none focus:border-orange-500"/>
                      <p class="mt-1 text-sm text-red-600 hidden" data-error="email">Veuillez saisir un email valide.</p>
                    </div>
                  </div>

                  <div>
                    <label for="contact-phone" class="flex items-center gap-2 text-sm font-medium">Téléphone</label>
                    <input id="contact-phone" name="phone" type="tel" placeholder="+224 XXX XXX XXX"
                           class="border flex h-10 w-full rounded-md px-3 py-2 bg-[var(--input-background)] outline-none focus:border-orange-500"/>
                  </div>

                    <div>
                    <label for="contact-subject" class="flex items-center gap-2 text-sm font-medium">Sujet</label>
                    <select id="contact-subject" name="subject" required
                        class="border flex h-10 w-full rounded-md px-3 py-2 bg-[var(--input-background)] outline-none focus:border-orange-500">
                      <option value="" disabled selected>Choisissez un sujet</option>
                      <option value="signaler un probleme">Signaler un problème</option>
                      <option value="demande de formation">Demande de formation</option>
                      <option value="demande de rendez vous">Demande de rendez-vous</option>
                      <option value="demande de soutien">Demande de soutien</option>
                      <option value="demande d'invitation">Demande d'invitation</option>
                    </select>
                    <p class="mt-1 text-sm text-red-600 hidden" data-error="subject">Veuillez indiquer un sujet.</p>
                    </div>

                  <div>
                    <label for="contact-message" class="flex items-center gap-2 text-sm font-medium">Message</label>
                    <textarea id="contact-message" name="message" rows="6" placeholder="Décrivez votre demande..." required
                              class="border w-full rounded-md px-3 py-2 bg-[var(--input-background)] outline-none focus:border-orange-500 resize-none"></textarea>
                    <p class="mt-1 text-sm text-red-600 hidden" data-error="message">Votre message ne peut pas être vide.</p>
                  </div>

                  <button type="submit"
                          class="w-full text-white text-lg py-4 rounded-md bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 transition">
                    Envoyer le Message
                  </button>

                  <!-- Toast -->
                  <div id="formToast" class="hidden mt-4 p-4 rounded-md text-white bg-green-600">Message envoyé avec succès. Merci !</div>
                </form>
              </div>
            </div>

            <!-- Colonne droite : cartes infos + réseaux + carte -->
            <div class="space-y-6">

              <div class="bg-white rounded-xl border overflow-hidden"></div>
                <div class="h-64 sm:h-80 md:h-96">
                  <iframe
                    title="Carte - Wanindara Centre de Santé, Conakry"
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d128982.69891355491!2d-13.661920797241777!3d9.64693323006856!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xf1d2a879264bc2f%3A0x10c5f771323ebd51!2sWanindara%20Centre%20de%20Sant%C3%A9!5e1!3m2!1sfr!2s!4v1762649019472!5m2!1sfr!2s"
                    class="w-full h-full border-0"
                    allowfullscreen
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <div class="p-4">
                  <p class="text-gray-600">Carte </p>
                  <p class="text-sm text-gray-500">Wanindara, Conakry — Wanindara Centre de Santé</p>
                  <a href="https://www.google.com/maps/place/Wanindara+Centre+de+Sant%C3%A9" target="_blank" rel="noopener noreferrer" class="mt-2 inline-block text-sm text-orange-600 hover:underline">Voir dans Google Maps</a>
                </div>
              </div>

            </div>
          </div>

        </div>
      </section>

    </div>
  </main>
  <!-- JS -->
  <script>
    // Form validation & real submit
    (function(){
        const form = document.getElementById('contactForm');
        const toast = document.getElementById('formToast');
    
        function setError(name, show){
            const el = form.querySelector('[data-error="'+name+'"]');
            if(!el) return;
            el.classList.toggle('hidden', !show);
        }
    
        function isEmail(v){
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
        }
    
        async function handleSubmit(e){
            e.preventDefault();
            const formData = new FormData(form);
            
            // RÉCUPÉRATION DU CSRF TOKEN
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            const name = (formData.get('name')||'').toString().trim();
            const email = (formData.get('email')||'').toString().trim();
            const subject = (formData.get('subject')||'').toString().trim();
            const message = (formData.get('message')||'').toString().trim();
    
            // Validation
            let valid = true;
            if(!name){ setError('name', true); valid = false; } else setError('name', false);
            if(!isEmail(email)){ setError('email', true); valid = false; } else setError('email', false);
            if(!subject){ setError('subject', true); valid = false; } else setError('subject', false);
            if(!message){ setError('message', true); valid = false; } else setError('message', false);
    
            if(!valid) return;
    
            // Désactiver le bouton pendant l'envoi
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Envoi en cours...';
            submitBtn.disabled = true;
    
            try {
                const response = await fetch('/contact/submit/', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest',
                        // AJOUT DU CSRF TOKEN DANS LES HEADERS
                        'X-CSRFToken': csrfToken
                    }
                });
    
                const result = await response.json();
    
                if (result.success) {
                    toast.textContent = result.message;
                    toast.className = 'mt-4 p-4 rounded-md text-white bg-green-600 animate-scale-in';
                    toast.classList.remove('hidden');
                    form.reset();
                } else {
                    toast.textContent = result.message;
                    toast.className = 'mt-4 p-4 rounded-md text-white bg-red-600 animate-scale-in';
                    toast.classList.remove('hidden');
                }
    
            } catch (error) {
                console.error('Erreur:', error);
                toast.textContent = 'Erreur de connexion. Veuillez réessayer.';
                toast.className = 'mt-4 p-4 rounded-md text-white bg-red-600 animate-scale-in';
                toast.classList.remove('hidden');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
    
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 5000);
            }
        }
    
        if(form){ 
            form.addEventListener('submit', handleSubmit); 
            
            form.querySelectorAll('input, textarea, select').forEach(input => {
                input.addEventListener('input', function() {
                    setError(this.name, false);
                });
            });
        }
    })();
  </script>

{% endblock content %}